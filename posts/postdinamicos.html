<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Post</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../style.css">
</head>
<body>
  <div class="post-container">
    <h1 id="post-title">Cargando título...</h1>
    <p id="post-date"></p>
    <img id="post-image" style="max-width: 100%; border-radius: 8px;" />
    <ul id="post-tags" class="ctn-tags"></ul>
    <div id="post-content"></div>
    <blockquote id="post-mensaje"></blockquote>
    <p><strong>Autor:</strong> <span id="post-author">Desconocido</span></p>
  </div>

  <script>
    async function cargarPost() {
      const params = new URLSearchParams(window.location.search);
      const postId = params.get('id');

      if (!postId) {
        document.body.innerHTML = '<h2>❌ ID de post no especificado.</h2>';
        return;
      }

      try {
        const res = await fetch(`http://localhost:3001/api/posts`);
        const { posts } = await res.json();
        const post = posts.find(p => p.id == postId);

        if (!post) {
          document.body.innerHTML = '<h2>❌ Post no encontrado.</h2>';
          return;
        }

        // Mostrar datos
        document.getElementById('post-title').textContent = post.title;
        document.getElementById('post-date').textContent = new Date(post.created_at).toLocaleDateString();
        document.getElementById('post-image').src = post.imageUrl || '../img/default.jpg';
        document.getElementById('post-content').innerHTML = post.content;
        document.getElementById('post-mensaje').textContent = post.mensaje_autor;
        document.getElementById('post-author').textContent = post.author_name || 'Anónimo';

        // Etiquetas
        const tagsContainer = document.getElementById('post-tags');
        const tags = post.etiquetas?.split(',') || [];
        tags.forEach(tag => {
          const li = document.createElement('li');
          li.textContent = tag.trim();
          tagsContainer.appendChild(li);
        });

      } catch (error) {
        console.error('Error al cargar post:', error);
        document.body.innerHTML = '<h2>❌ Error al cargar el post.</h2>';
      }
    }

    cargarPost();
  </script>
  <script src="scriptPosts.js"></script>
</body>
</html>
